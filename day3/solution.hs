

main :: IO ()
main = do
  putStrLn "Part 1:"
  putStrLn $ show $ trees (1, 3)

  putStrLn "Part 2:"
  let results = do
        (right, down) <- [ ( 1,  1)
                         , ( 3,  1)
                         , ( 5,  1)
                         , ( 7,  1)
                         , ( 1,  2)
                         ]
        pure $ trees (down, right)
  putStrLn $ show $ foldl (*) 1 $ results

trees :: (Int, Int) -> Int
trees (down, right) = length $ filter ( '#' == ) foo
  where
    foo = fmap (\(i, s) -> s !! ((right*i) `mod` length s)) $ filter (\(i, s) -> i `mod` down == 0) $ zip [0..] input

input :: [String]
input =
  [ "....#...............##...#...#."
  , "#...#..#.....##.##.#.##....#..."
  , "...#.....#...#................."
  , "#..#..#.......#...#.#.........."
  , "...##..#.#..........##...#....."
  , "........###.#.##..#............"
  , "...###......##.#..#.#...#.#...."
  , "......##..#.#....#...#........."
  , ".................#......#......"
  , "..............##....#.........."
  , "#.....................#...#.#.#"
  , ".##..#............##...##.##..#"
  , ".....#.####...#..##......#.#..#"
  , "#.......#.#..#......##.#.#....#"
  , ".....##...###.#..........##...."
  , "#...........#.##....##.....#..#"
  , "..###..##.##.....#....#........"
  , "...#.#.#............#.#..#....#"
  , "#......#....#...##.#.#.#.#..#.."
  , ".......#.#...#..#..#..##......#"
  , ".....#..#.............#..#...#."
  , "##..#.##.....#........#........"
  , "....##....#..#...........#...#."
  , ".......#........##.......##...."
  , "..##...#.......#........##.#..."
  , "..........#..#.....##........#."
  , "..#..##..#............#........"
  , ".#.#...#...#.......#......#...."
  , "....#....#.....#.#.........###."
  , ".............#...#....#..#.#..."
  , "##.#...#..#......#.#.##.....#.."
  , "#...##.#..........#..#.#...#..."
  , "#####.......#.#.....#..#......."
  , "#...#...#........#....#...#...."
  , "......##.#..#..#............#.."
  , "....#....#.......#...###......."
  , ".#......##...#.##....#...#....."
  , "..#....#...##.....#.#...##.#..."
  , "#.......#........#.####........"
  , "#.##..#..#.........#.#........#"
  , ".#...#.#.#.#......#....#.#..#.."
  , "#...####...##.##.#....#......##"
  , "..#...#......##........#.....#."
  , "...#.#....##..................."
  , "...##................#........."
  , "...##.....##........#....#..#.."
  , ".........#..#.....#............"
  , ".#..#.......................#.."
  , ".#.........#..##........#.#.#.#"
  , "......#.....##..#.##...#..#.##."
  , "..#..............##.......#...."
  , "...............##....#...##..#."
  , "###...#..###.........#...#....."
  , "...#..#...#....#.....##........"
  , "....#..##...#........#........."
  , "..#......#.......#.....#..#...."
  , ".#...........##.....###....#..."
  , ".#..#.....##.........##.....#.."
  , "....##.#.....#................#"
  , "..#..#......#.#..#....#..##...."
  , "#.....#...##............#......"
  , ".#.............#....#.......#.."
  , "#.........#..#...##.#...#.#.##."
  , "...#......#..####....#.#.....#."
  , "......#........#..........##.##"
  , "......##.#..##.##.....#........"
  , "##.....#..##.##..#.......##...."
  , ".##.........#...........#...#.."
  , ".....#...###..#...#...........#"
  , "..........#.#......#.###.....#."
  , "...#.............#.##......##.."
  , "#.##.........#..###...........#"
  , "....#..##....#..#..#........###"
  , "...#........##.......##..#..#.."
  , "...#......#..#.#..............."
  , "#......###....#.#..#.#..#....#."
  , "#.#.####.#.........#..#.#.#...."
  , ".....#....#...............#...#"
  , ".#........#......#.#...#......."
  , "................#...#.....##..."
  , ".............#...####.........."
  , ".................##....##.###.."
  , "#................#......#......"
  , ".###.#........#..##.....#..###."
  , "..#.#..#...#..#.#...#.#.....#.#"
  , ".....#............#..##..#..#.#"
  , "#........##.#...#.....#........"
  , "#.#.#..###......###............"
  , "...#..#...........##...#.....#."
  , "......#........#...#.#....#...."
  , "....#..........#.#..#.#....##.."
  , "...#.....##..#......#.#.##...#."
  , ".........#..#................#."
  , "..#....#.##.....#.......#......"
  , "...#.....#.......##.##.....#..."
  , "#...#..............#..###..#..."
  , "#.#......#.#....#........##..#."
  , "...#...##...##..#.........#...."
  , "..#...#......##.#.#.#....##...."
  , "#.......#.......#..#..#........"
  , ".........#..#.....#....#.....##"
  , ".#......#.......#.#..#..#...#.#"
  , "..#....#.#..#.................."
  , "#.....####..........#.#.....#.#"
  , ".#..#.#.#....#.#.....#.#......."
  , "....##......#..#.....#.#.#...#."
  , "...##...#......##.#....##.#...."
  , "..#..##....#...#...........#..."
  , ".......#........#...##.#......."
  , "#.#..#....##.#....##..........."
  , ".......#............#..##..##.."
  , "#.#.#.....#....##.#.#.#.....#.."
  , "##...#...#.......#..#...#.....#"
  , "##..##.##..........#........##."
  , "..............#.....#..#..##..."
  , ".......#...#.........#....#.#.."
  , "...#..#..#....#.#....##........"
  , "..#.......#....#....##........."
  , "#...#.....#..#.#...##....#....."
  , ".....##..#..##..#.............."
  , ".....##............#....#.#...."
  , "..#.....#....##.#.....#..#....."
  , "#...#..#..#......#.#.#..##....."
  , ".............................##"
  , "#...#.#................#....#.#"
  , ".#.#.#....##......###..##......"
  , "#.....#..#.##.#.#.##...###....."
  , ".........#............##..#...."
  , ".#..#...#....#.....#.#........#"
  , "...............#......#..#....."
  , "...................###........#"
  , ".###..##..##.......#.#........."
  , "#.........#......#....#.#...#.."
  , ".#.#....#.......#.#..##...##..."
  , ".#.....#....##.......#.#.....#."
  , ".........#...#....#.#.........."
  , "....###..#..##.#...##....#..#.."
  , "...#.#..##.#.........###.#..#.."
  , "#...#...........#....#........."
  , "....##...........#.#.#......###"
  , "#....#...........##..#........."
  , "###....#.....#.......#....###.."
  , ".#.......#....#.#.#.#......#.#."
  , "........#...............#.#.#.."
  , "....#.........#.....#...##.##.#"
  , "...#............#.............#"
  , "..........#..#................."
  , "........#.....##............#.#"
  , "..#...##........#...#.....#.#.."
  , "....#........#.#.#..........#.."
  , "#.#...#...........#............"
  , "....#.#...##...........#.....#."
  , "...........#.#..#.....#........"
  , ".....#..#..#..#.....#.#.....#.#"
  , "#.....#.......#.......#...#...."
  , "#.........#....#.#........#..#."
  , "...#..#.........#.....#..#....."
  , "...#..#.............#.........."
  , ".#.......#..........#.....#...#"
  , ".....#.#......#.......#....#..."
  , "...#.....#..#..##....##....#..."
  , ".#.#.#..#...#.....#....#......."
  , "..##.#..........#.....#.#......"
  , "..#..#.............#...##..##.."
  , ".#.............#..#....##...#.."
  , "..#...#.....#.................#"
  , "..##.......#.....#...#....#...."
  , ".#..#.##.........#...#.#...#..."
  , "...##.......##..#.....##.##...#"
  , "........####.#.........#......."
  , "..#.#...##.#..#..#.......##.#.."
  , ".#..#............###..#..#....."
  , "#.....#.#...#.#.......#........"
  , "..........#......#.#...#...#..."
  , "..#......#..#..#.#...#........."
  , "..###........#.#....#.#...##..."
  , ".#.....#..#.#......#........#.."
  , ".#...#..#...#....#.......#..#.."
  , "..#....#..#.....#.#........#..."
  , "#..#.#.........#..........#..#."
  , ".#.....##....#.........#.#.#.#."
  , "#.#...#.....#.#.#....#.#..#...."
  , ".........#...................#."
  , "..#.....#..##...#..........#.#."
  , "..............#....#.........#."
  , ".#....#.....#..............##.."
  , "#...#...#.#........##.........#"
  , "....###....#.#....#.#.........#"
  , ".....#........#.....##........."
  , ".#...##..##..#.........##......"
  , "............#.....#........#..."
  , "..#....#.......#......#..#.#.#."
  , "#.......#.#...........#..##.#.."
  , "......#.##......#....#.......#."
  , ".....#........#...###.....#...."
  , "###..........#........#.#.#...."
  , ".....#...#.#...#...#...##.....#"
  , ".##...#.#........#.#....#......"
  , "......#.........#.....#.#......"
  , ".....#.##.....###.#...#...##..#"
  , ".#.#.......##....#..#..#.##...."
  , ".####...###.#.#.#.#............"
  , "......#..##...#..........#.##.#"
  , "......#............#..........."
  , ".....#.#..#.......##...##......"
  , "......#........#..#....#.#.#.#."
  , "#..#..#.....#..#.....#.......#."
  , ".#...#.....#..............#...."
  , ".#....#..#.##.#............####"
  , "..........#....#.##...#.#......"
  , "...#.#.#.#.#.......#.........#."
  , "##........#..##..#.........#..."
  , "..#......#...#..#.#.....#......"
  , "..#.#......#...#...#.#........."
  , "........................##....."
  , "...#.##.#........#...#.......#."
  , "..#.#......#....##........#.#.."
  , "#......#.##........#..#......#."
  , ".....#..#..#.............#....."
  , "......#......#........#....#..."
  , "...#....###.....#..#.#....#...."
  , "#.......................#....#."
  , "..#...#...................#...."
  , "....#..#.....##.#..#...#.....#."
  , "...#.........#...#.......#....."
  , "..#....#.....#...#...#.#####..."
  , ".....####......#...........#..."
  , "......#.#..........#...#.#.#..#"
  , "###..#.#....#..#..............."
  , "...#...###..#..#.#.#..........."
  , ".....#...#.##.#.#.###..##......"
  , ".........#...........#....##.#."
  , "....#..#......#................"
  , "...........#..#..#...#.#......."
  , "..#.....#......##.###.........."
  , ".........#...................#."
  , "..........#...#.#....##........"
  , "..#...##....#....#.......#...##"
  , "#......#.....#...#...#...#....."
  , "....##...#.#.......#.#...##...."
  , "...#.....#....#.....#....#....."
  , "#....##.....##..##..........##."
  , ".....#.....#.#.#..............."
  , ".#.##....#.....#.#..#....#..##."
  , ".....#.#.....##....#..........."
  , ".........#..#.......##..##....."
  , "..#....##.....###...#....#.#..."
  , "............#......#.#...#..#.."
  , "#..##......#.#.##....#.#......."
  , ".#.#.....#...#.#.#....#.....#.."
  , "#....#..#.#....#...#..........."
  , "......#.#.....#...#.#.#......#."
  , "###..#....#.###.............#.."
  , "..............#####........###."
  , "..#..#.#.#.#......#......#....."
  , "###.........#.#..........#..#.#"
  , ".#.........#...#......####....."
  , "..#.......####..#....#...#..#.."
  , "#.#..#.#...............#.#.#.#."
  , "###....#.....##.#....#......##."
  , "..#..#........#....###.#.#....."
  , "...#.#..........#.....#...#...."
  , "....#......##.#............#..#"
  , "...##...#.....#..##....#..#.#.#"
  , ".......#.....#..#....#....##.#."
  , ".#..#....#..#......##....##...#"
  , "..#......#...#.#..###..#.##...."
  , "#...#.....#......##...#.......#"
  , ".....#.#.....#...##............"
  , ".#..##.##..#..##.#........#...."
  , "....#.#......##...#.#.#.#..##.."
  , ".#..............##........#...."
  , ".##....#..#..#....#...#......#."
  , "............###....##.......##."
  , "..............####.....#......."
  , "........##..##.#...#.......#..."
  , "....#..#.....##.......#####...#"
  , ".##..##..#.....#...#..#..#....#"
  , "##..#.#.#...........#.........."
  , "#..#......#...#....#..........."
  , "...#..##.#..........#..#......."
  , "........#.#.....#......##......"
  , ".....#....#............#......."
  , ".#.#..#....##......#.......###."
  , ".#..#.#........#......#...##..#"
  , "...#....#......#..#........#.##"
  , ".........#..#...#..#.#.##......"
  , "....###.#...........#...#......"
  , ".##............#.......#..##..."
  , "##...#.#...............#.#...##"
  , "..#..#.....#.#..#..#..........."
  , "..#..#.##..#......#.##..#.#...."
  , "..#...#......#.#...#....##.#..."
  , "...###....####......#....#...#."
  , ".......##........#.....##....#."
  , ".........##..........#...#....."
  , ".....#............#.##.#....#.#"
  , "..........#...#....##.........."
  , "....................#......#..."
  , "#......#..#...#.............##."
  , "...........#..................."
  , "..#...#.........#.##.#..##.#..."
  , "#.#....#.#.....#............#.."
  , ".#..#.....#.....####......#.#.."
  , "#....#.......##..#...........#."
  , "............#...#.....#..#.#..."
  , "#...........#...#####....#...#."
  , "..........#...###..##.........#"
  , "#.....###............#..#..#.#."
  , "...##.....#....#......#.....#.."
  , "#....#.......#..#......###...#."
  , "...##.##......##..##..........#"
  , ".......#.#..#.#..#.#.#.#..#..#."
  , "..#..###...#....#.....#......#."
  , "...#.........#..#.##.#.....###."
  , "..#.........#.##.#..#..#..###.."
  , "..####..#.........#.........#.#"
  , "..#.#...#.......#....##........"
  , ".#......#.#...................."
  , "..........#.......#.#..#..#...."
  , "..#........#....#.#..#........."
  , "..#.....#.............#....#..."
  , "##...#.........#.....#...#....."
  ]
